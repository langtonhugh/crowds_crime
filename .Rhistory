linkthing = c((datenums$rownums[i]-datenums$rownums[1]+1):(datenums$rownums[i + 1] - datenums$rownums[1])),
datenum = datenums$dates[i])
} else {
datalist[[i]] = data.frame(linkthing = c(datenums$rownums[i]:331),
datenum = datenums$dates[i])
}
}
results <- do.call(rbind, datalist)
link_df <- left_join(link_df, results)
# Look through versus teams.
datalist <- list()
for (i in 1:nrow(gamenums)) {
if (i < nrow(gamenums)) {
datalist[[i]] = data.frame(
linkthing = c((gamenums$rownums[i]-gamenums$rownums[1]+1):(gamenums$rownums[i + 1] - gamenums$rownums[1])),
game = gamenums$games[i])
} else {
datalist[[i]] = data.frame(linkthing = c(gamenums$rownums[i]:331),
game = gamenums$games[i])
}
}
results <- do.call(rbind, datalist)
results
# Clean and tidy up.
link_cleaned_df <- link_df %>%
left_join(results) %>%
select(-linkthing) %>%
unique() %>%
rowwise() %>%
mutate(datenum = trimws(datenum)) %>%
separate(col = datenum, sep = " ", into = c("dayweek", "month", "daynum", "year"), remove = F) %>%
unite(col = "full_date", month, daynum, year, sep = " ") %>%
filter(full_date != "NA NA NA") %>%
mutate(full_date_mdy = mdy(full_date),
week          = trimws(tolower(gsub(" ", "_", trimws(weeknum))))) %>%
separate(game, into = c("game_cleaned", "time1", "time2", "network"), sep = "  +", remove = F) %>%
separate(game_cleaned, into = c("away","home"), sep = " at ", remove = F) %>% # warning is fine - just intro NA.
mutate(home  = str_replace(home, " \\(.*\\)", ""),
home  = str_replace_all(home, "[[:punct:]]", ""),
away  = str_replace_all(away, "[[:punct:]]", ""))
# time1 = str_replace_all(time1, pattern = "FOX/NFLN\r|NBC\r|ESPN\r|FOX\r" , replacement = ""),
# time2 = str_replace_all(time2, pattern = "FOX/NFLN\r|NBC\r|ESPN\r|FOX\r|CBS| \r|NFLN\r|TBD|\r" , replacement = ""))
View(link_cleaned_df)
# Join
all_nfl <- crim_nfl %>%
rename(home = tm) %>%
left_join(link_cleaned_df) %>%
drop_na(full_date_mdy)
View(all_nfl)
View(all_nfl)
time1 = str_replace_all(time1, pattern = "FOX/NFLN\r|NBC\r|ESPN\r|FOX\r" , replacement = ""),
time2 = str_replace_all(time2, pattern = "FOX/NFLN\r|NBC\r|ESPN\r|FOX\r|CBS| \r|NFLN\r|TBD|\r" , replacement = ""))
# Clean and tidy up.
link_cleaned_df <- link_df %>%
left_join(results) %>%
select(-linkthing) %>%
unique() %>%
rowwise() %>%
mutate(datenum = trimws(datenum)) %>%
separate(col = datenum, sep = " ", into = c("dayweek", "month", "daynum", "year"), remove = F) %>%
unite(col = "full_date", month, daynum, year, sep = " ") %>%
filter(full_date != "NA NA NA") %>%
mutate(full_date_mdy = mdy(full_date),
week          = trimws(tolower(gsub(" ", "_", trimws(weeknum))))) %>%
separate(game, into = c("game_cleaned", "time1", "time2", "network"), sep = "  +", remove = F) %>%
separate(game_cleaned, into = c("away","home"), sep = " at ", remove = F) %>% # warning is fine - just intro NA.
mutate(home  = str_replace(home, " \\(.*\\)", ""),
home  = str_replace_all(home, "[[:punct:]]", ""),
away  = str_replace_all(away, "[[:punct:]]", "")) %>%
time1 = str_replace_all(time1, pattern = "FOX/NFLN\r|NBC\r|ESPN\r|FOX\r" , replacement = ""),
time2 = str_replace_all(time2, pattern = "FOX/NFLN\r|NBC\r|ESPN\r|FOX\r|CBS| \r|NFLN\r|TBD|\r" , replacement = ""))
# Clean and tidy up.
link_cleaned_df <- link_df %>%
left_join(results) %>%
select(-linkthing) %>%
unique() %>%
rowwise() %>%
mutate(datenum = trimws(datenum)) %>%
separate(col = datenum, sep = " ", into = c("dayweek", "month", "daynum", "year"), remove = F) %>%
unite(col = "full_date", month, daynum, year, sep = " ") %>%
filter(full_date != "NA NA NA") %>%
mutate(full_date_mdy = mdy(full_date),
week          = trimws(tolower(gsub(" ", "_", trimws(weeknum))))) %>%
separate(game, into = c("game_cleaned", "time1", "time2", "network"), sep = "  +", remove = F) %>%
separate(game_cleaned, into = c("away","home"), sep = " at ", remove = F) %>% # warning is fine - just intro NA.
mutate(home  = str_replace(home, " \\(.*\\)", ""),
home  = str_replace_all(home, "[[:punct:]]", ""),
away  = str_replace_all(away, "[[:punct:]]", ""),
time1 = str_replace_all(time1, pattern = "FOX/NFLN\r|NBC\r|ESPN\r|FOX\r" , replacement = ""),
time2 = str_replace_all(time2, pattern = "FOX/NFLN\r|NBC\r|ESPN\r|FOX\r|CBS| \r|NFLN\r|TBD|\r" , replacement = ""))
View(crim_nfl)
View(all_nfl)
# Clean and tidy up.
link_cleaned_df <- link_df %>%
left_join(results) %>%
select(-linkthing) %>%
unique() %>%
rowwise() %>%
mutate(datenum = trimws(datenum)) %>%
separate(col = datenum, sep = " ", into = c("dayweek", "month", "daynum", "year"), remove = F) %>%
unite(col = "full_date", month, daynum, year, sep = " ") %>%
filter(full_date != "NA NA NA") %>%
mutate(full_date_mdy = mdy(full_date),
week          = trimws(tolower(gsub(" ", "_", trimws(weeknum))))) %>%
separate(game, into = c("game_cleaned", "time1", "time2", "network"), sep = "  +", remove = F) %>%
separate(game_cleaned, into = c("away","home"), sep = " at ", remove = F) %>% # warning is fine - just intro NA.
mutate(home  = str_replace(home, " \\(.*\\)", ""),
home  = str_replace_all(home, "[[:punct:]]", ""),
away  = str_replace_all(away, "[[:punct:]]", ""),
time1 = str_replace_all(time1, pattern = "FOX/NFLN\r|NBC\r|ESPN\r|FOX\r|FOX/NFLN" , replacement = ""),
time2 = str_replace_all(time2, pattern = "FOX/NFLN\r|NBC\r|ESPN\r|FOX\r|CBS| \r|NFLN\r|TBD|\r" , replacement = ""))
View(crim_nfl)
View(all_nfl)
# Clean and tidy up.
link_cleaned_df <- link_df %>%
left_join(results) %>%
select(-linkthing) %>%
unique() %>%
rowwise() %>%
mutate(datenum = trimws(datenum)) %>%
separate(col = datenum, sep = " ", into = c("dayweek", "month", "daynum", "year"), remove = F) %>%
unite(col = "full_date", month, daynum, year, sep = " ") %>%
filter(full_date != "NA NA NA") %>%
mutate(full_date_mdy = mdy(full_date),
week          = trimws(tolower(gsub(" ", "_", trimws(weeknum))))) %>%
separate(game, into = c("game_cleaned", "time1", "time2", "network"), sep = "  +", remove = F) %>%
separate(game_cleaned, into = c("away","home"), sep = " at ", remove = F) %>% # warning is fine - just intro NA.
mutate(home  = str_replace(home, " \\(.*\\)", ""),
home  = str_replace_all(home, "[[:punct:]]", ""),
away  = str_replace_all(away, "[[:punct:]]", ""),
time1 = str_replace_all(time1, pattern = "FOX/NFLN\r|NBC\r|ESPN\r|FOX\r|FOX/NFLN" , replacement = ""),
time2 = str_replace_all(time2, pattern = "FOX/NFLN\r|NBC\r|ESPN\r|FOX\r|CBS| \r|NFLN\r|TBD|\r|FOX" , replacement = ""))
View(all_nfl)
# Clean and tidy up.
link_cleaned_df <- link_df %>%
left_join(results) %>%
select(-linkthing) %>%
unique() %>%
rowwise() %>%
mutate(datenum = trimws(datenum)) %>%
separate(col = datenum, sep = " ", into = c("dayweek", "month", "daynum", "year"), remove = F) %>%
unite(col = "full_date", month, daynum, year, sep = " ") %>%
filter(full_date != "NA NA NA") %>%
mutate(full_date_mdy = mdy(full_date),
week          = trimws(tolower(gsub(" ", "_", trimws(weeknum))))) %>%
separate(game, into = c("game_cleaned", "time1", "time2", "network"), sep = "  +", remove = F) %>%
separate(game_cleaned, into = c("away","home"), sep = " at ", remove = F) %>% # warning is fine - just intro NA.
mutate(home  = str_replace(home, " \\(.*\\)", ""),
home  = str_replace_all(home, "[[:punct:]]", ""),
away  = str_replace_all(away, "[[:punct:]]", ""),
time1 = str_replace_all(time1, pattern = "FOX/NFLN\r|NBC\r|ESPN\r|FOX\r|FOX/NFLN" , replacement = ""),
time2 = str_replace_all(time2, pattern = "FOX/NFLN\r|NBC\r|ESPN\r|FOX\r|CBS| \r|NFLN\r|TBD|\r" , replacement = ""))
View(all_nfl)
library(crimedata)     # crime data
library(nflscrapR)     # NFL data
library(janitor)       # cleaning
library(dplyr)         # wrangling
library(stringr)       # wrangling
library(tidyr)         # wrangling
library(sf)            # maps
library(lubridate)     # dates
library(rnaturalearth) # boundaries
library(ggplot2)       # visual
library(pdftools)      # get pdf data
# NFL attendance data.
nfl_attend <- read.csv("data/nfl_2018.csv")
# NFL location data.
nfl_coords <- read.csv("https://raw.githubusercontent.com/Sinbad311/CloudProject/master/NFL%20Stadium%20Latitude%20and%20Longtitude.csv")
# Clean coords.
nfl_coords <- nfl_coords %>%
clean_names() %>%
mutate(team = if_else(team == "Forty-Niners", "49ers", as.character(team)))
# Clean attendance.
nfl_attend <- nfl_attend %>%
clean_names() %>%
rowwise() %>%
mutate(team = last(str_split(tm, " ")[[1]])) %>%
left_join(., nfl_coords, by = c('team' = 'team')) %>%
filter(!is.na(conference))
# Cities in the open crime data.
crimedata_cities <- data.frame(
city = c("Chicago", "Detroit", "Fort Worth", "Kansas City", "Los Angeles", "Louisville", "New York", "San Francisco", "Tucson", "Virginia	Beach")
)
# Further clean and join.
crim_nfl <- nfl_attend %>%
mutate(city = str_replace(tm, team, ""),
city = trimws(city)) %>%
left_join(crimedata_cities) %>%
select(-home, -away, -total, -x, -pic) %>%
pivot_longer(cols = starts_with("week"), names_to = "week", values_to = "attend") %>%
mutate(attend_clean = str_replace(attend, "\\\\", ""),
attend_clean = str_replace(attend_clean, "\\*", ""),
attend_clean = trimws(attend_clean),
attend_clean = ifelse(attend_clean == "Bye", NA, attend_clean)) %>%
drop_na(attend_clean)
# Read in pdf.
thing <- pdf_text("https://nflcommunications.com/Documents/2018%20Offseason/04%2019%2018%20-%202018%20Schedule%20Release.pdf") %>% strsplit(split = "\n")
# Subset pages 3 to 9 for the relevant info.
thing <- unlist(thing[3:9])
# Create df to grab week titles.
weeknums <- data.frame(
rownums = which(grepl("WEEK", thing)),
weeks = thing[which(grepl("WEEK", thing))]
)
# Create df for dates of games.
datenums <- data.frame(
rownums = which(grepl(", 2018", thing)),
dates = thing[which(grepl(", 2018", thing))]
)
# Create data frame for games e.g. team1 at team2.
gamenums <- data.frame(
rownums = which(grepl(" at ", thing)),
games = thing[which(grepl(" at ", thing))]
)
# IDs.
link_df <- data.frame(
linkthing = c(1:329)
)
# Loop through weeks.
datalist <- list()
for (i in 1:nrow(weeknums)) {
if (i < nrow(weeknums)) {
datalist[[i]] = data.frame(
linkthing = c((weeknums$rownums[i]-weeknums$rownums[1]+1):(weeknums$rownums[i + 1] - weeknums$rownums[1])),
weeknum = weeknums$weeks[i])
} else {
datalist[[i]] = data.frame(linkthing = c(weeknums$rownums[i]:331),
weeknum = weeknums$weeks[i])
}
}
results <- do.call(rbind, datalist)
link_df <- left_join(link_df, results)
# Loop through dates.
datalist <- list()
for (i in 1:nrow(datenums)) {
if (i < nrow(datenums)) {
datalist[[i]] = data.frame(
linkthing = c((datenums$rownums[i]-datenums$rownums[1]+1):(datenums$rownums[i + 1] - datenums$rownums[1])),
datenum = datenums$dates[i])
} else {
datalist[[i]] = data.frame(linkthing = c(datenums$rownums[i]:331),
datenum = datenums$dates[i])
}
}
results <- do.call(rbind, datalist)
link_df <- left_join(link_df, results)
# Look through versus teams.
datalist <- list()
for (i in 1:nrow(gamenums)) {
if (i < nrow(gamenums)) {
datalist[[i]] = data.frame(
linkthing = c((gamenums$rownums[i]-gamenums$rownums[1]+1):(gamenums$rownums[i + 1] - gamenums$rownums[1])),
game = gamenums$games[i])
} else {
datalist[[i]] = data.frame(linkthing = c(gamenums$rownums[i]:331),
game = gamenums$games[i])
}
}
results <- do.call(rbind, datalist)
# Clean and tidy up.
link_cleaned_df <- link_df %>%
left_join(results) %>%
select(-linkthing) %>%
unique() %>%
rowwise() %>%
mutate(datenum = trimws(datenum)) %>%
separate(col = datenum, sep = " ", into = c("dayweek", "month", "daynum", "year"), remove = F) %>%
unite(col = "full_date", month, daynum, year, sep = " ") %>%
filter(full_date != "NA NA NA") %>%
mutate(full_date_mdy = mdy(full_date),
week          = trimws(tolower(gsub(" ", "_", trimws(weeknum))))) %>%
separate(game, into = c("game_cleaned", "time1", "time2", "network"), sep = "  +", remove = F) %>%
separate(game_cleaned, into = c("away","home"), sep = " at ", remove = F) %>% # warning is fine - just intro NA.
mutate(home  = str_replace(home, " \\(.*\\)", ""),
home  = str_replace_all(home, "[[:punct:]]", ""),
away  = str_replace_all(away, "[[:punct:]]", ""),
time1 = str_replace_all(time1, pattern = "FOX/NFLN\r|NBC\r|ESPN\r|FOX\r|FOX/NFLN" , replacement = ""),
time2 = str_replace_all(time2, pattern = "FOX/NFLN\r|NBC\r|ESPN\r|FOX\r|CBS| \r|NFLN\r|TBD|\r" , replacement = ""))
# Join.
all_nfl <- crim_nfl %>%
rename(home = tm) %>%
left_join(link_cleaned_df) %>%
drop_na(full_date_mdy)
View(all_nfl)
crimes <- get_crime_data(
years = 2018,
cities = unique(crim_nfl$city),
type = "core"
)
crim_nfl$city
all_nfl$city
# Join.
all_nfl <- crim_nfl %>%
rename(home = tm) %>%
left_join(link_cleaned_df) %>%
drop_na(full_date_mdy) %>%
filter(city %in% crimedata_cities$city)
View(all_nfl)
crimes <- get_crime_data(
years = 2018,
cities = unique(all_nfl$city),
type = "core"
)
crimes_df <- crimes_df %>%
mutate(date_single_2 = ymd_hms(date_single))
crimes_df <- crimes
crimes_df <- crimes_df %>%
mutate(date_single_2 = ymd_hms(date_single))
View(crimes_df)
crimes_df <- crimes_df %>%
mutate(date_single_2 = as.Date(date_single_2))
crimes_df <- get_crime_data(
years = 2018,
cities = unique(all_nfl$city),
type = "core"
)
crimes_df <- crimes_df %>%
mutate(full_date_mdy = ymd_hms(date_single))
View(crimes_df)
crimes_df <- crimes_df %>%
mutate(full_date_mdy = ymd_hms(date_single),
full_date_mdy2 = as.Date(date_single))
crimes_df <- crimes_df %>%
mutate(full_date_mdy = ymd_hms(date_single),
full_date_mdy2 = as.Date(date_single, "%m/%d/%Y"))
crimes_df <- crimes_df %>%
mutate(full_date_mdy = ymd(date_single),
full_date_mdy2 = as.Date(date_single))
crimes_df <- crimes_df %>%
mutate(full_date_ymd = ymd(date_single)
)
crimes_df <- crimes_df %>%
mutate(full_date_mdy = ymd_hms(date_single))
crimes_df <- crimes_df %>%
mutate(full_date_mdy = ymd_hms(date_single)),
full_date_mdy2 = as.Date(date_single))
crimes_df <- crimes_df %>%
mutate(full_date_mdy = ymd_hms(date_single),
full_date_mdy2 = as.Date(date_single))
crimes_df <- crimes_df %>%
mutate(full_date_ymd = as.Date(date_single))
crimes_df <- crimes_df %>%
mutate(full_date_ymd = as.Date(date_single)) %>%
filter(full_date_ymd %in% all_nfl$full_date_ymd)
all_nfl$full_date_ymd
crimes_df <- crimes_df %>%
mutate(full_date_ymd = as.Date(date_single)) %>%
filter(full_date_ymd %in% all_nfl$full_date_mdy)
# Join.
all_nfl <- crim_nfl %>%
rename(home = tm) %>%
left_join(link_cleaned_df) %>%
drop_na(full_date_mdy) %>%
filter(city %in% crimedata_cities$city)
# Download open crime data for 2018.
crimes_df <- get_crime_data(
years = 2018,
cities = unique(all_nfl$city),
type = "core"
)
View(all_nfl)
# Clean and tidy up.
link_cleaned_df <- link_df %>%
left_join(results) %>%
select(-linkthing) %>%
unique() %>%
rowwise() %>%
mutate(datenum = trimws(datenum)) %>%
separate(col = datenum, sep = " ", into = c("dayweek", "month", "daynum", "year"), remove = F) %>%
unite(col = "full_date", month, daynum, year, sep = " ") %>%
filter(full_date != "NA NA NA") %>%
mutate(full_date_ymd = ymd(full_date),
week          = trimws(tolower(gsub(" ", "_", trimws(weeknum))))) %>%
separate(game, into = c("game_cleaned", "time1", "time2", "network"), sep = "  +", remove = F) %>%
separate(game_cleaned, into = c("away","home"), sep = " at ", remove = F) %>% # warning is fine - just intro NA.
mutate(home  = str_replace(home, " \\(.*\\)", ""),
home  = str_replace_all(home, "[[:punct:]]", ""),
away  = str_replace_all(away, "[[:punct:]]", ""),
time1 = str_replace_all(time1, pattern = "FOX/NFLN\r|NBC\r|ESPN\r|FOX\r|FOX/NFLN" , replacement = ""),
time2 = str_replace_all(time2, pattern = "FOX/NFLN\r|NBC\r|ESPN\r|FOX\r|CBS| \r|NFLN\r|TBD|\r" , replacement = ""))
# Clean and tidy up.
link_cleaned_df <- link_df %>%
left_join(results) %>%
select(-linkthing) %>%
unique() %>%
rowwise() %>%
mutate(datenum = trimws(datenum)) %>%
separate(col = datenum, sep = " ", into = c("dayweek", "month", "daynum", "year"), remove = F) %>%
unite(col = "full_date", month, daynum, year, sep = " ") %>%
filter(full_date != "NA NA NA") %>%
mutate(full_date_mdy = mdy(full_date),
week          = trimws(tolower(gsub(" ", "_", trimws(weeknum))))) %>%
separate(game, into = c("game_cleaned", "time1", "time2", "network"), sep = "  +", remove = F) %>%
separate(game_cleaned, into = c("away","home"), sep = " at ", remove = F) %>% # warning is fine - just intro NA.
mutate(home  = str_replace(home, " \\(.*\\)", ""),
home  = str_replace_all(home, "[[:punct:]]", ""),
away  = str_replace_all(away, "[[:punct:]]", ""),
time1 = str_replace_all(time1, pattern = "FOX/NFLN\r|NBC\r|ESPN\r|FOX\r|FOX/NFLN" , replacement = ""),
time2 = str_replace_all(time2, pattern = "FOX/NFLN\r|NBC\r|ESPN\r|FOX\r|CBS| \r|NFLN\r|TBD|\r" , replacement = ""))
View(link_cleaned_df)
link_cleaned_df <- link_df %>%
left_join(results) %>%
select(-linkthing) %>%
unique() %>%
rowwise() %>%
mutate(datenum = trimws(datenum)) %>%
separate(col = datenum, sep = " ", into = c("dayweek", "month", "daynum", "year"), remove = F) %>%
unite(col = "full_date", month, daynum, year, sep = " ") %>%
filter(full_date != "NA NA NA")
View(link_cleaned_df)
# Clean and tidy up.
link_cleaned_df <- link_df %>%
left_join(results) %>%
select(-linkthing) %>%
unique() %>%
rowwise() %>%
mutate(datenum = trimws(datenum)) %>%
separate(col = datenum, sep = " ", into = c("dayweek", "month", "daynum", "year"), remove = F) %>%
unite(col = "full_date", month, daynum, year, sep = " ") %>%
filter(full_date != "NA NA NA") %>%
mutate(full_date_mdy = mdy(full_date),
week          = trimws(tolower(gsub(" ", "_", trimws(weeknum))))) %>%
separate(game, into = c("game_cleaned", "time1", "time2", "network"), sep = "  +", remove = F) %>%
separate(game_cleaned, into = c("away","home"), sep = " at ", remove = F) %>% # warning is fine - just intro NA.
mutate(home  = str_replace(home, " \\(.*\\)", ""),
home  = str_replace_all(home, "[[:punct:]]", ""),
away  = str_replace_all(away, "[[:punct:]]", ""),
time1 = str_replace_all(time1, pattern = "FOX/NFLN\r|NBC\r|ESPN\r|FOX\r|FOX/NFLN" , replacement = ""),
time2 = str_replace_all(time2, pattern = "FOX/NFLN\r|NBC\r|ESPN\r|FOX\r|CBS| \r|NFLN\r|TBD|\r" , replacement = ""))
test <- arrange(link_cleaned_df$full_date_mdy)
test <- arrange(link_cleaned_df, full_date_mdy)
View(test)
# Clean and tidy up.
link_cleaned_df <- link_df %>%
left_join(results) %>%
select(-linkthing) %>%
unique() %>%
rowwise() %>%
mutate(datenum = trimws(datenum)) %>%
separate(col = datenum, sep = " ", into = c("dayweek", "month", "daynum", "year"), remove = F) %>%
unite(col = "full_date", month, daynum, year, sep = " ") %>%
filter(full_date != "NA NA NA") %>%
mutate(full_date_ymd = mdy(full_date),
week          = trimws(tolower(gsub(" ", "_", trimws(weeknum))))) %>%
separate(game, into = c("game_cleaned", "time1", "time2", "network"), sep = "  +", remove = F) %>%
separate(game_cleaned, into = c("away","home"), sep = " at ", remove = F) %>% # warning is fine - just intro NA.
mutate(home  = str_replace(home, " \\(.*\\)", ""),
home  = str_replace_all(home, "[[:punct:]]", ""),
away  = str_replace_all(away, "[[:punct:]]", ""),
time1 = str_replace_all(time1, pattern = "FOX/NFLN\r|NBC\r|ESPN\r|FOX\r|FOX/NFLN" , replacement = ""),
time2 = str_replace_all(time2, pattern = "FOX/NFLN\r|NBC\r|ESPN\r|FOX\r|CBS| \r|NFLN\r|TBD|\r" , replacement = ""))
View(crimes_df)
crimes_df <- crimes_df %>%
mutate(full_date_ymd = ymd(as.Date(date_single))) %>%
filter(full_date_ymd %in% all_nfl$full_date_ymd)
crimes_df <- get_crime_data(
years = 2018,
cities = unique(all_nfl$city),
type = "core"
)
View(crimes_df)
?str_select
mutate(date_single = str_extract(date_single, "^.{10}")
)
names(crimes_df)
crimes_filter_df <- crimes_df %>%
mutate(date_single = str_extract(date_single, "^.{10}"))
View(crimes_filter_df)
crimes_filter_df <- crimes_df %>%
mutate(date_single = str_extract(date_single, "^.{10}"),
date_single_ymd = ymd(date_single))
crimes_filter_df <- crimes_df %>%
mutate(date_single = str_extract(date_single, "^.{10}"),
date_single_ymd = ymd(date_single)) %>%
filter(date_single_ymd %in% all_nfl$full_date_mdy)
View(crimes_filter_df)
nfl_crimes_df <- left_join(all_nfl, crimes_filter_df)
View(nfl_crimes_df)
View(crimes_filter_df)
View(crimes_filter_df)
View(all_nfl)
crimes_filter_df <- crimes_df %>%
mutate(date_single = str_extract(date_single, "^.{10}"),
date_single_ymd = ymd(date_single)) %>%
filter(date_single_ymd %in% all_nfl$full_date_mdy)
table(crimes_filter_df$date_single_ymd)
table(all_nfl$full_date_mdy)
View(all_nfl)
crimes_filter_df <- crimes_df %>%
mutate(date_single = str_extract(date_single, "^.{10}"),
date_single_ymd = ymd(date_single)) %>%
filter(date_single_ymd %in% all_nfl$full_date_mdy) %>%
group_by(city, date_single_ymd) %>%
summarise(crimes = n())
crimes_filter_df <- crimes_df %>%
mutate(date_single = str_extract(date_single, "^.{10}"),
date_single_ymd = ymd(date_single)) %>%
filter(date_single_ymd %in% all_nfl$full_date_mdy) %>%
group_by(city_name, home, away, date_single_ymd) %>%
summarise(crimes = n())
View(crimes_df)
crimes_filter_df <- crimes_df %>%
mutate(date_single = str_extract(date_single, "^.{10}"),
date_single_ymd = ymd(date_single)) %>%
filter(date_single_ymd %in% all_nfl$full_date_mdy) %>%
group_by(city_name) %>%
summarise(crimes = n())
crimes_filter_df <- crimes_df %>%
mutate(date_single = str_extract(date_single, "^.{10}"),
date_single_ymd = ymd(date_single)) %>%
filter(date_single_ymd %in% all_nfl$full_date_mdy)
View(crimes_filter_df)
